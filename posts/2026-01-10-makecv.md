---
{
    "title": "makecv",
    "description": "Tiny curriculum builder.",
    "date": "January 10, 2026",
    "permalink": "/makecv/index.html",
    "layout": "default.mustache",
    "draft": true,
    "collection": "experiments"
}
---
<!--html-->
<div id="app" class="fixed top-0 left-0 w-full h-full min-h-0" style="display:none;"></div>
<div id="landing" class="w-full" style="display:none;"></div>

<script type="module">
    import kofi from "/vendor/kofi.js";

    // reference to dom containers
    const appContainer = document.querySelector(`div#app`);
    const landingContainer = document.querySelector(`div#landing`);

    // global variables
    const FORM_TYPES = {
        TEXT: "text",
    };
    const ELEMENT_TYPES = {
        HEADING: "heading",
        PARAGRAPH: "paragraph",
    };
    const ELEMENTS = {
        [ELEMENT_TYPES.HEADING]: {
            title: "Heading",
            description: "",
            fields: {
                text: {
                    type: FORM_TYPES.TEXT,
                    title: "Content",
                },
            },
        },
        [ELEMENT_TYPES.PARAGRAPH]: {
            title: "Paragraph",
            description: "",
            fields: {
                text: {
                    type: FORM_TYPES.TEXT,
                    title: "Content",
                },
            },
        },
    };

    // renderer for form options
    const FormOptions = {
        [FORM_TYPES.TEXT]: props => {
            const className = kofi.classNames({
                "block w-full bg-white border-1 border-gray-200 px-2 py-1 h-8 text-sm rounded-lg": true,
            });
            const handleChange = event => {
                return props.onChange(event.target.value || "");
            };
            return kofi.html`
                <input type="text" className="${className}" value="${props.value}" onChange="${handleChange}" />
            `;
        },
    };

    // application components
    const ui = {
        Icon: props => kofi.html`
            <svg width="1em" height="1em">
                <svg:use href="/vendor/icons.svg#${props.icon || ""}" />
            </svg>
        `,
        Logo: () => kofi.html`
            <div className="flex items-center leading-none tracking-tight">
                <div className="flex items-center">
                    <div className="font-bold">make</div>
                    <div className="font-light opacity-60">cv</div>
                </div>
            </div>
        `,
        Header: props => kofi.html`
            <div className="shrink-0 bg-gray-950 text-white flex flex-row items-center justify-between h-16 p-3">
                <div className="text-2xl">
                    ${ui.Logo()}
                </div>
                ${props.rightContent ? props.rightContent() : ""}
            </div>
        `,
        Form: props => kofi.html`
            <div className="flex flex-col gap-4">
                ${Object.keys(props.fields).map(field => kofi.html`
                    <div className="flex flex-col gap-1">
                        ${props.fields[field].title ? kofi.html`
                            <div className="font-bold text-sm">${props.fields[field].title}</div>
                        ` : ""}
                        ${FormOptions[props.fields[field].type]({
                            value: props.data[field],
                            disabled: false,
                            onChange: value => props.onChange(field, value),
                        })}
                    </div>
                `)}
            </div>
        `,
    };

    // create the app instance
    const app = kofi.emitter({
        "init": () => {
            Object.assign(app.state, {
                data: {
                    elements: [
                        {
                            id: "heading01",
                            type: ELEMENT_TYPES.HEADING,
                            text: "Hello World",
                        },
                    ],
                },
                activeElement: null,
            });
            app.state.activeElement = app.state.data.elements[0];
            appContainer.style.display = "";
            app.emit("render:editor");
        },
        "render:editor": () => {
            kofi.render(kofi.html`
                <div className="w-full h-full min-h-0 flex flex-col">
                    ${ui.Header({})}
                    <div className="grow-1 h-full w-full flex items-stretch">
                        <div className="w-full max-w-64 h-full bg-white shrink-0 border-l-1 border-gray-200 p-3">
                            <span>Tree</span>
                        </div>
                        <div className="w-full h-full grow-1 bg-gray-50"></div>
                        ${app.state.activeElement ? kofi.html`
                            <div className="relative w-full max-w-md h-full bg-white shrink-0 border-r-1 border-gray-200 p-3">
                                <div className="sticky top-0 w-full bg-white pb-4 flex items-center justify-between">
                                    <div className="font-bold">
                                        <span>${ELEMENTS[app.state.activeElement.type].title}</span>
                                    </div>
                                </div>
                                ${ui.Form({
                                    data: app.state.activeElement,
                                    fields: ELEMENTS[app.state.activeElement.type].fields,
                                    onChange: (field, value) => {
                                        app.state.activeElement[field] = value;
                                        // TODO: debounce reloading preview
                                    },
                                })}
                            </div>
                        ` : ""}
                    </div>
                </div>
            `, appContainer);
        },
        "render:preview": () => {
            return null;
        },
    });

    // initialize the app
    app.emit("init");
</script>
<!--/html-->
